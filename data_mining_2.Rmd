```{r}
source("https://raw.githubusercontent.com/cefet-rj-dal/daltoolbox/main/jupyter.R")

load_library("daltoolbox")
load_library("ggplot2")
load_library("dplyr")
load_library("tidyr")
load_library("reshape")
load_library("RColorBrewer")
load_library("corrplot")
load_library("WVPlots")
load_library("GGally")
load_library("aplpack")
load_library("gridExtra")

library(ROSE)
library(dplyr)
library(rpart)
library(caret)
```

Define fonte e esquema de cores para os gráficos
```{r}
colors <- brewer.pal(9, 'Set1')
font <- theme(text = element_text(size=16))
```

Carregar o arquivo CSV
Dados preenchidos com strings vazias são considerados NA
```{r}
dados <- read.csv("students_mental_health_survey.csv", na.strings = "")
```

Visualizar as primeiras linhas
```{r}
head(dados)
```
Visualizar a estrutura dos dados
```{r}
str(dados)
```

Visualizar dados faltantes
```{r}
missing_data <- colSums(is.na(dados))
missing_data <- missing_data[missing_data > 0]
print(missing_data)
```
Preencher dados faltantes
```{r}
dados$CGPA[is.na(dados$CGPA)] <- mean(dados$CGPA, na.rm = TRUE) # CGPA preenchido com a média
dados$Substance_Use[is.na(dados$Substance_Use)] <- names(which.max(table(dados$Substance_Use))) # Substance_Use preenchido com a moda
```

Encoding dos atributos categóricos
```{r}
dados[, !sapply(dados, is.numeric)]

```

Remoção de outliers

```{r}

out_obj <- outliers()

out_obj <- fit(out_obj, dados)

dados_limpos <- transform(out_obj, dados)

head(dados_limpos)

nrow(dados_limpos)
```
 Criar a variável de classe com base no Depression_Score
Vamos considerar "Alto" para scores maiores que 2 e "Baixo" para os menores ou iguais a 2
```{r}
dados$Class <- ifelse(dados$Depression_Score > 2, "Alto", "Baixo")

table(dados$Class)
```
Realizar Undersampling
```{r}
minoria_count <- table(dados$Class)["Alto"]
dados_balanced_us <- ovun.sample(Class ~ ., data = dados, method = "under", N = minoria_count)$data
table(dados_balanced_us$Class)
str(dados_balanced_us)

```
Realizar Oversampling

```{r}
n_maior <- table(dados$Class)["Baixo"]
dados_balanced_os <- ovun.sample(Class ~ ., data = dados, method = "over", N = n_maior * 2)$data
table(dados_balanced_os$Class)
str(dados_balanced_os)

```

